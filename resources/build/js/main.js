!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=29)}([function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"h",function(){return s}),n.d(t,"d",function(){return a}),n.d(t,"e",function(){return l}),n.d(t,"f",function(){return u}),n.d(t,"g",function(){return c}),n.d(t,"i",function(){return h}),n.d(t,"j",function(){return _}),n.d(t,"k",function(){return d}),n.d(t,"l",function(){return f}),n.d(t,"m",function(){return E}),n.d(t,"n",function(){return m}),n.d(t,"o",function(){return v});var i={CONTENT_MAP_URL:"./resources/build/data/contentMap.xml",LOUPE_URL:"./resources/build/images/Loupe.png"};Object.freeze(i);var r={WIDTH:76,HEIGHT:100,GAP:10,SCALE:.14,SKEW:.66};Object.freeze(r);var o={MARGIN:7,MINIMUM_STEM_WIDTH:16};Object.freeze(o);var s={GRAY_CHANNEL:"190",THEME:"#48BBEE"};Object.freeze(s);var a={AUTO:"auto",BOTTOM:"bottom",LEFT:"left",NONE:"none",MARGIN_TOP:"margin-top",MIN_HEIGHT:"min-height",MIN_WIDTH:"min-width",POSITION_ABSOLUTE:"absolute",POSITION_STATIC:"static",PX:"px",RIGHT:"right",SCALE:"scale",TRANSLATE:"translate"};Object.freeze(a);var l={BOOK_PAGE_LEFT:"animationBookPageLeft",BOOK_PAGE_RIGHT:"animationBookPageRight",CONTENT_NODE_APPEND:"animationContentNodeAppend",CONTENT_NODE_REMOVE:"animationContentNodeRemove",FADE_IN:"animationFadeIn",FADE_OUT:"animationFadeOut",IMAGE_PRELOADER:"animationImagePreloader",TEXT_FIELD_DESELECT:"animationTextFieldDeselect",TEXT_FIELD_SELECT:"animationTextFieldSelect",TITLE:"animationTitle"};Object.freeze(l);var u={CONTENT_NODE:"contentNode",CONTENT_NODE_LEAF:"contentNodeLeaf",CONTENT_NODE_ROOT:"contentNodeRoot",LOUPE:"loupe",PICTURE:"picture",SUSPEND_POINTER_EVENTS:"suspendPointerEvents",TEXT_FIELD_ACTIVE:"textFieldActive",TEXT_FIELD_FOOTNOTE:"textFieldFootnote",TEXT_FIELD_WHITESPACE:"textFieldWhitespace"};Object.freeze(u);var c={BACKGROUND:"background",BOOK:"book",BRACKET:"bracket",CONTENT:"content",MASK:"mask",OUTLINE:"outline",PAGE_LEFT:"pageLeft",PAGE_RIGHT:"pageRight",SKIN:"skin",ZOOM:"zoom"};Object.freeze(c);var h={ATTRIBUTE_DOWNLOAD:"download",ATTRIBUTE_FOOTNOTE:"footnote",ATTRIBUTE_HEIGHT:"height",ATTRIBUTE_HREF:"href",ATTRIBUTE_ID:"id",ATTRIBUTE_LABEL:"label",ATTRIBUTE_URL:"url",ATTRIBUTE_WIDTH:"width",ATTRIBUTE_ZOOMABLE:"zoomable",BRANCH:"branch",LEAF:"leaf",ROOT:"root"};Object.freeze(h);var _={ANIMATION_END:"animationend",CLICK:"click",CONTEXT_MENU:"contextmenu",DRAG_START:"dragstart",KEYDOWN:"keydown",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_MOVE:"mousemove",MOUSE_WHEEL:"wheel",RESIZE:"resize",UPDATE_CONTENT:"updateContent"};Object.freeze(_);var d={ANCHOR:"a",ANCHOR_TARGET_BLANK:"_blank",ANCHOR_TARGET_SELF:"_self",CANVAS_RENDERING_CONTEXT_2D:"2d",CANVAS:"canvas",DIV:"div",IMG:"img",TYPE:"type"};Object.freeze(d);var f={CONTENT:document.getElementById("content"),ICON:document.getElementById("icon"),MAIN:document.getElementsByTagName("main")[0],TITLE:document.getElementById("title")};Object.freeze(f);var E={ARROW_DOWN:"ArrowDown",ARROW_LEFT:"ArrowLeft",ARROW_RIGHT:"ArrowRight",ARROW_UP:"ArrowUp",DOWN:"Down",LEFT:"Left",RIGHT:"Right",UP:"Up"};Object.freeze(E);var m={TRANSLATION:.5,WIDTH:1};Object.freeze(m);var v={ZOOM_DEFAULT:1,ZOOM_INSTRUCTION:"image zoom:  mouse over and scroll or press keyboard arrows.  hold shift to accelerate.",ZOOM_MAX:4,ZOOM_STEP:.01,ZOOM_STEP_ACCELERATED:.1};Object.freeze(v)},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){var i=n(8),r=n(22);e.exports=n(4)?function(e,t,n){return i.f(e,t,r(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var i=n(24)("wks"),r=n(12),o=n(1).Symbol,s="function"==typeof o;(e.exports=function(e){return i[e]||(i[e]=s&&o[e]||(s?o:r)("Symbol."+e))}).store=i},function(e,t,n){e.exports=!n(20)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t){var n=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var i=n(9),r=n(35),o=n(36),s=Object.defineProperty;t.f=n(4)?Object.defineProperty:function(e,t,n){if(i(e),t=o(t,!0),i(n),r)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var i=n(10);e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){var i=n(1),r=n(2),o=n(5),s=n(12)("src"),a=Function.toString,l=(""+a).split("toString");n(19).inspectSource=function(e){return a.call(e)},(e.exports=function(e,t,n,a){var u="function"==typeof n;u&&(o(n,"name")||r(n,"name",t)),e[t]!==n&&(u&&(o(n,s)||r(n,s,e[t]?""+e[t]:l.join(String(t)))),e===i?e[t]=n:a?e[t]?e[t]=n:r(e,t,n):(delete e[t],r(e,t,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[s]||a.call(this)})},function(e,t){var n=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+i).toString(36))}},function(e,t){e.exports={}},function(e,t,n){var i=n(43),r=n(7);e.exports=function(e){return i(r(e))}},function(e,t,n){var i=n(24)("keys"),r=n(12);e.exports=function(e){return i[e]||(i[e]=r(e))}},function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=function(){function e(){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.constructor.name===e.name)throw new Error("Cannot instantiate abstract class.");this._listeners=new Map}return i(e,[{key:"addListener",value:function(e,t){this.hasListener(e)||this._listeners.set(e,[]),this._listeners.get(e).push(t)}},{key:"hasListener",value:function(e){return this._listeners.has(e)}},{key:"removeListener",value:function(e,t){if(this.hasListener(e)){var n=this._listeners.get(e);n.length>1?n.splice(n.indexOf(t),1):this._listeners.delete(e)}}},{key:"dispatch",value:function(e){if(this.hasListener(e)){for(var t=this._listeners.get(e),n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];var o=!0,s=!1,a=void 0;try{for(var l,u=t[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){l.value.apply(void 0,i)}}catch(e){s=!0,a=e}finally{try{!o&&u.return&&u.return()}finally{if(s)throw a}}}}},{key:"dispose",value:function(){this._listeners=null}}]),e}();t.a=r},function(e,t,n){"use strict";var i=n(16),r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0};var s=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i._url=e,i._XHRErrorHandler=i._XHRErrorHandler.bind(i),i._XHRProgressHandler=i._XHRProgressHandler.bind(i),i._XHRCompleteHandler=i._XHRCompleteHandler.bind(i),i._xhr=new XMLHttpRequest,i._xhr.responseType=n,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["a"]),r(t,[{key:"_XHRErrorHandler",value:function(e){throw this._removeEventListeners(e.target),new Error("File Read Error")}},{key:"_XHRProgressHandler",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispatch",this).call(this,t.Event.PROGRESS,{loaded:e.loaded,total:e.total})}},{key:"_XHRCompleteHandler",value:function(e){var n=e.target;if(this._removeEventListeners(n),404===n.status)throw new Error("File Not Found");o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispatch",this).call(this,t.Event.COMPLETE,{target:this,response:n.response})}},{key:"_removeEventListeners",value:function(e){e.removeEventListener(t.Event.ERROR,this._XHRErrorHandler),e.removeEventListener(t.Event.PROGRESS,this._XHRProgressHandler),e.removeEventListener("load",this._XHRCompleteHandler)}},{key:"load",value:function(){var e=this._xhr;e.addEventListener(t.Event.ERROR,this._XHRErrorHandler),e.addEventListener(t.Event.PROGRESS,this._XHRProgressHandler),e.addEventListener("load",this._XHRCompleteHandler),e.open("GET",this._url),e.send()}},{key:"abort",value:function(){this._removeEventListeners(this._xhr),this._xhr.abort()}},{key:"dispose",value:function(){this.abort(),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispose",this).call(this),this._xhr=null}}],[{key:"Event",get:function(){return{COMPLETE:"complete",ERROR:"error",PROGRESS:"progress"}}},{key:"ResponseType",get:function(){return{ARRAY_BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"}}}]),t}();t.a=s},function(e,t,n){"use strict";var i=n(33),r=n(34),o=n(11),s=n(2),a=n(13),l=n(39),u=n(26),c=n(49),h=n(3)("iterator"),_=!([].keys&&"next"in[].keys()),d=function(){return this};e.exports=function(e,t,n,f,E,m,v){l(n,t,f);var p,T,O,y=function(e){if(!_&&e in A)return A[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},L=t+" Iterator",N="values"==E,g=!1,A=e.prototype,b=A[h]||A["@@iterator"]||E&&A[E],I=b||y(E),R=E?N?y("entries"):I:void 0,C="Array"==t&&A.entries||b;if(C&&(O=c(C.call(new e)))!==Object.prototype&&O.next&&(u(O,L,!0),i||"function"==typeof O[h]||s(O,h,d)),N&&b&&"values"!==b.name&&(g=!0,I=function(){return b.call(this)}),i&&!v||!_&&!g&&A[h]||s(A,h,I),a[t]=I,a[L]=d,E)if(p={values:N?I:y("values"),keys:m?I:y("keys"),entries:R},v)for(T in p)T in A||o(A,T,p[T]);else r(r.P+r.F*(_||g),t,p);return p}},function(e,t){var n=e.exports={version:"2.5.5"};"number"==typeof __e&&(__e=n)},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var i=n(10),r=n(1).document,o=i(r)&&i(r.createElement);e.exports=function(e){return o?r.createElement(e):{}}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var i=n(42),r=n(25);e.exports=Object.keys||function(e){return i(e,r)}},function(e,t,n){var i=n(1),r=i["__core-js_shared__"]||(i["__core-js_shared__"]={});e.exports=function(e){return r[e]||(r[e]={})}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var i=n(8).f,r=n(5),o=n(3)("toStringTag");e.exports=function(e,t,n){e&&!r(e=n?e:e.prototype,o)&&i(e,o,{configurable:!0,value:t})}},function(e,t,n){"use strict";var i=n(0),r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var o=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._scale=t,this._color=n,this._init()}return r(e,[{key:"_init",value:function(){this._element=document.createElement(i.k.DIV);var e=this._element;e.id=i.g.BOOK,e.style.lineHeight=0,this._draw()}},{key:"_draw",value:function(){this._leftPageCanvas=document.createElement(i.k.CANVAS);var e=this._leftPageCanvas;e.id=i.g.PAGE_LEFT,e.width=i.b.WIDTH*this._scale,e.height=i.b.HEIGHT*this._scale,e.style.transformOrigin=i.d.RIGHT+" "+i.d.BOTTOM;var t=e.getContext(i.k.CANVAS_RENDERING_CONTEXT_2D);t.fillStyle=this._color,t.transform(1,i.b.SKEW,0,1,0,0),t.fillRect(0,0,i.b.WIDTH*this._scale,i.b.HEIGHT/2*this._scale),t.fill(),this._rightPageCanvas=document.createElement(i.k.CANVAS);var n=this._rightPageCanvas;n.id=i.g.PAGE_RIGHT,n.width=i.b.WIDTH*this._scale,n.height=i.b.HEIGHT*this._scale,n.style.transformOrigin=i.d.LEFT+" "+i.d.BOTTOM;var r=n.getContext(i.k.CANVAS_RENDERING_CONTEXT_2D);for(r.fillStyle=this._color,r.transform(1,-i.b.SKEW,0,1,0,i.b.HEIGHT/2*this._scale),r.fillRect(i.b.GAP*this._scale,0,i.b.WIDTH*this._scale,i.b.HEIGHT/2*this._scale),r.fill();this._element.firstChild;)this._element.removeChild(this._element.firstChild);var o=this._element;o.appendChild(e),o.appendChild(n)}},{key:"dispose",value:function(){for(;this._element.firstChild;)this._element.removeChild(this._element.firstChild);this._element=null,this._leftPageCanvas=null,this._rightPageCanvas=null}},{key:"element",get:function(){return this._element}},{key:"scale",set:function(e){this._scale=e,this._draw()},get:function(){return this._scale}},{key:"color",set:function(e){this._color=e,this._draw()},get:function(){return this._color}}]),e}();t.a=o},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i={a:void 0,b:void 0,c:void 0,d:void 0,tx:void 0,ty:void 0};function r(e){var t=window.getComputedStyle(e,null).getPropertyValue("transform");if(t){var n=Object.assign({},i),r=t.replace(/^.*\((.*)\)$/g,"$1").split(/, +/).map(Number);return Object.keys(n).forEach(function(e,t){n[e]=r[t]}),n}}Object.seal(i)},function(e,t,n){n(30),e.exports=n(56)},function(e,t,n){n(31),n(51),e.exports=n(55).f("iterator")},function(e,t,n){"use strict";var i=n(32)(!0);n(18)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=i(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){var i=n(6),r=n(7);e.exports=function(e){return function(t,n){var o,s,a=String(r(t)),l=i(n),u=a.length;return l<0||l>=u?e?"":void 0:(o=a.charCodeAt(l))<55296||o>56319||l+1===u||(s=a.charCodeAt(l+1))<56320||s>57343?e?a.charAt(l):o:e?a.slice(l,l+2):s-56320+(o-55296<<10)+65536}}},function(e,t){e.exports=!1},function(e,t,n){var i=n(1),r=n(19),o=n(2),s=n(11),a=n(37),l=function(e,t,n){var u,c,h,_,d=e&l.F,f=e&l.G,E=e&l.S,m=e&l.P,v=e&l.B,p=f?i:E?i[t]||(i[t]={}):(i[t]||{}).prototype,T=f?r:r[t]||(r[t]={}),O=T.prototype||(T.prototype={});for(u in f&&(n=t),n)h=((c=!d&&p&&void 0!==p[u])?p:n)[u],_=v&&c?a(h,i):m&&"function"==typeof h?a(Function.call,h):h,p&&s(p,u,h,e&l.U),T[u]!=h&&o(T,u,_),m&&O[u]!=h&&(O[u]=h)};i.core=r,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,n){e.exports=!n(4)&&!n(20)(function(){return 7!=Object.defineProperty(n(21)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var i=n(10);e.exports=function(e,t){if(!i(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!i(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var i=n(38);e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){"use strict";var i=n(40),r=n(22),o=n(26),s={};n(2)(s,n(3)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=i(s,{next:r(1,n)}),o(e,t+" Iterator")}},function(e,t,n){var i=n(9),r=n(41),o=n(25),s=n(15)("IE_PROTO"),a=function(){},l=function(){var e,t=n(21)("iframe"),i=o.length;for(t.style.display="none",n(48).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;i--;)delete l.prototype[o[i]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(a.prototype=i(e),n=new a,a.prototype=null,n[s]=e):n=l(),void 0===t?n:r(n,t)}},function(e,t,n){var i=n(8),r=n(9),o=n(23);e.exports=n(4)?Object.defineProperties:function(e,t){r(e);for(var n,s=o(t),a=s.length,l=0;a>l;)i.f(e,n=s[l++],t[n]);return e}},function(e,t,n){var i=n(5),r=n(14),o=n(45)(!1),s=n(15)("IE_PROTO");e.exports=function(e,t){var n,a=r(e),l=0,u=[];for(n in a)n!=s&&i(a,n)&&u.push(n);for(;t.length>l;)i(a,n=t[l++])&&(~o(u,n)||u.push(n));return u}},function(e,t,n){var i=n(44);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var i=n(14),r=n(46),o=n(47);e.exports=function(e){return function(t,n,s){var a,l=i(t),u=r(l.length),c=o(s,u);if(e&&n!=n){for(;u>c;)if((a=l[c++])!=a)return!0}else for(;u>c;c++)if((e||c in l)&&l[c]===n)return e||c||0;return!e&&-1}}},function(e,t,n){var i=n(6),r=Math.min;e.exports=function(e){return e>0?r(i(e),9007199254740991):0}},function(e,t,n){var i=n(6),r=Math.max,o=Math.min;e.exports=function(e,t){return(e=i(e))<0?r(e+t,0):o(e,t)}},function(e,t,n){var i=n(1).document;e.exports=i&&i.documentElement},function(e,t,n){var i=n(5),r=n(50),o=n(15)("IE_PROTO"),s=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=r(e),i(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?s:null}},function(e,t,n){var i=n(7);e.exports=function(e){return Object(i(e))}},function(e,t,n){for(var i=n(52),r=n(23),o=n(11),s=n(1),a=n(2),l=n(13),u=n(3),c=u("iterator"),h=u("toStringTag"),_=l.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=r(d),E=0;E<f.length;E++){var m,v=f[E],p=d[v],T=s[v],O=T&&T.prototype;if(O&&(O[c]||a(O,c,_),O[h]||a(O,h,v),l[v]=_,p))for(m in i)O[m]||o(O,m,i[m],!0)}},function(e,t,n){"use strict";var i=n(53),r=n(54),o=n(13),s=n(14);e.exports=n(18)(Array,"Array",function(e,t){this._t=s(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,r(1)):r(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(e,t,n){var i=n(3)("unscopables"),r=Array.prototype;void 0==r[i]&&n(2)(r,i,{}),e.exports=function(e){r[i][e]=!0}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){t.f=n(3)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(new(n(57).a)).init()},function(e,t,n){"use strict";var i=n(0),r=n(27),o=n(58),s=n(17),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"init",value:function(){this._isMobileDevice=window.navigator.userAgent.toLowerCase().includes("mobi"),this._isMobileDevice||document.addEventListener(i.j.KEYDOWN,function(e){switch(e.key){case i.m.ARROW_DOWN:case i.m.DOWN:case i.m.ARROW_LEFT:case i.m.LEFT:case i.m.ARROW_RIGHT:case i.m.RIGHT:case i.m.ARROW_UP:case i.m.UP:e.preventDefault()}}),this._contentNodeMap=new Map,this._dataLoaderCompleteHandler=this._dataLoaderCompleteHandler.bind(this),this._deselectAnimationEndHandler=this._deselectAnimationEndHandler.bind(this),this._removeAnimationEndHandler=this._removeAnimationEndHandler.bind(this),this._updateContentHandler=this._updateContentHandler.bind(this),this._appendContentAnimationEndHandler=this._appendContentAnimationEndHandler.bind(this),this._bookPageRightAnimationEndHandler=this._bookPageRightAnimationEndHandler.bind(this);var e=new s.a(i.a.CONTENT_MAP_URL,s.a.ResponseType.DOCUMENT);e.addListener(s.a.Event.COMPLETE,this._dataLoaderCompleteHandler),e.load()}},{key:"_dataLoaderCompleteHandler",value:function(e){e.target.removeListener(s.a.Event.COMPLETE,this._dataLoaderCompleteHandler),this._data=e.response;var t=new r.a(i.b.SCALE,i.h.THEME);i.l.ICON.appendChild(t.element),i.l.CONTENT.classList.add(i.f.SUSPEND_POINTER_EVENTS),this._appendContent(i.i.ROOT)}},{key:"_updateContentHandler",value:function(e){this._selectedTextFieldID=e,i.l.CONTENT.classList.add(i.f.SUSPEND_POINTER_EVENTS);var t=document.getElementById(this._selectedTextFieldID);t.classList.remove(i.f.TEXT_FIELD_ACTIVE);var n=t.parentNode;this._removeContent(n)}},{key:"_removeContent",value:function(e){if(e.getAttribute(i.k.TYPE)!==i.i.LEAF){var t=e.childNodes,n=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var l=s.value;if(l.nodeType===Node.ELEMENT_NODE&&l.classList.contains(i.e.TEXT_FIELD_SELECT)){l.addEventListener(i.j.ANIMATION_END,this._deselectAnimationEndHandler),l.classList.remove(i.e.TEXT_FIELD_SELECT),l.classList.add(i.e.TEXT_FIELD_DESELECT);break}}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}}if(!this._contentLastChild){var u=e.nextSibling;u&&u.nodeType===Node.ELEMENT_NODE?(u===i.l.CONTENT.lastChild&&(this._contentLastChild=u),u.addEventListener(i.j.ANIMATION_END,this._removeAnimationEndHandler),u.classList.remove(i.e.CONTENT_NODE_APPEND),u.classList.add(i.e.CONTENT_NODE_REMOVE),this._removeContent(u)):this._appendContent(this._selectedTextFieldID)}}},{key:"_deselectAnimationEndHandler",value:function(e){var t=e.target;t.removeEventListener(i.j.ANIMATION_END,this._deselectAnimationEndHandler),t.classList.remove(i.e.TEXT_FIELD_DESELECT),t.classList.remove(i.f.SUSPEND_POINTER_EVENTS),t.classList.add(i.f.TEXT_FIELD_ACTIVE)}},{key:"_removeAnimationEndHandler",value:function(e){var t=this,n=e.target;n.removeEventListener(i.j.ANIMATION_END,this._removeAnimationEndHandler),n.classList.remove(i.e.CONTENT_NODE_REMOVE),i.l.CONTENT.removeChild(n),this._contentLastChild===n&&(this._contentLastChild=null,setTimeout(function(){return t._appendContent(t._selectedTextFieldID)},0));var r=n.id,o=this._contentNodeMap;o.get(r).dispose(),o.delete(r)}},{key:"_appendContent",value:function(e){var t=void 0,n=void 0,r=document.getElementById(e);if(r){r.classList.add(i.f.SUSPEND_POINTER_EVENTS),r.classList.add(i.e.TEXT_FIELD_SELECT);var s=r.parentElement.getAttribute(i.k.TYPE)===i.i.ROOT,a=r.clientHeight;t=s?0:r.parentElement.clientWidth-r.clientWidth,n=a*Array.from(r.parentElement.children).indexOf(r)+a/2}var l=this._data.getElementById(e),u=this._contentNodeMap;u.set(e,new o.a(l,t,n,this._isMobileDevice));var c=u.get(e);c.addListener(i.j.UPDATE_CONTENT,this._updateContentHandler),c.element.addEventListener(i.j.ANIMATION_END,this._appendContentAnimationEndHandler),i.l.CONTENT.appendChild(c.element),e!==i.i.ROOT?c.element.classList.add(i.e.CONTENT_NODE_APPEND):this._initLaunchAnimation()}},{key:"_appendContentAnimationEndHandler",value:function(e){e.target.removeEventListener(i.j.ANIMATION_END,this._appendContentAnimationEndHandler),i.l.CONTENT.classList.remove(i.f.SUSPEND_POINTER_EVENTS)}},{key:"_initLaunchAnimation",value:function(){var e=document.getElementById(i.g.PAGE_RIGHT);e.addEventListener(i.j.ANIMATION_END,this._bookPageRightAnimationEndHandler),e.classList.add(i.e.BOOK_PAGE_RIGHT),i.l.TITLE.classList.add(i.e.TITLE)}},{key:"_bookPageRightAnimationEndHandler",value:function(e){e.target.removeEventListener(i.j.ANIMATION_END,this._bookPageRightAnimationEndHandler),document.getElementById(i.g.PAGE_LEFT).classList.add(i.e.BOOK_PAGE_LEFT),document.querySelector("."+i.f.CONTENT_NODE_ROOT).classList.add(i.e.CONTENT_NODE_APPEND)}}]),e}();t.a=l},function(e,t,n){"use strict";var i=n(0),r=n(28),o=n(59),s=n(16),a=n(60),l=n(63),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0};var h=function(e){function t(e,n,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o._contentParentNode=e,o._bracketStemWidth=n,o._bracketStemHeight=i,o._isMobileDevice=r,o._init(),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["a"]),u(t,[{key:"_init",value:function(){if(!(this._contentParentNode instanceof Node&&this._contentParentNode.nodeType===Node.ELEMENT_NODE&&this._contentParentNode.hasChildNodes()))throw new Error("Invalid constructor argument.");var e=this._contentParentNode.nodeName;if(this._element=document.createElement(i.k.DIV),this._element.id=this._contentParentNode.id,this._element.setAttribute(i.k.TYPE,e),this._appendChildNodes(i.i.ATTRIBUTE_URL,this._createPicture.bind(this)),this._appendChildNodes(i.i.ATTRIBUTE_LABEL,this._createTextField.bind(this)),e===i.i.ROOT)this._element.classList.add(i.f.CONTENT_NODE_ROOT);else if(this._bracket=new o.a(this._bracketStemWidth,this._bracketStemHeight),this._element.appendChild(this._bracket.element),e===i.i.LEAF){if(this._element.classList.add(i.f.CONTENT_NODE_LEAF),this._createLeafMutationObserver(),this._picture){if(this._picture.isZoomable){var t=document.createElement(i.k.DIV);t.setAttribute(i.i.ATTRIBUTE_LABEL,i.o.ZOOM_INSTRUCTION),t.setAttribute(i.i.ATTRIBUTE_FOOTNOTE,i.i.ATTRIBUTE_FOOTNOTE),this._element.appendChild(this._createTextField(t).element)}this._element.insertBefore(this._bracket.element,this._picture.element)}}else this._element.classList.add(i.f.CONTENT_NODE),this._bracket.draw(this._elementClientRect().height)}},{key:"_appendChildNodes",value:function(e,t){var n=this._contentParentNode.childNodes,i=!0,r=!1,o=void 0;try{for(var s,a=n[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var l=s.value;if(l.nodeType===Node.ELEMENT_NODE&&l.getAttribute(e)){var u=t(l);this._element.appendChild(u.element)}}}catch(e){r=!0,o=e}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}}},{key:"_createPicture",value:function(e){var t=e.getAttribute(i.i.ATTRIBUTE_URL),n=parseInt(e.getAttribute(i.i.ATTRIBUTE_WIDTH)),r=parseInt(e.getAttribute(i.i.ATTRIBUTE_HEIGHT)),o=e.getAttribute(i.i.ATTRIBUTE_ZOOMABLE)&&!this._isMobileDevice;return this._picture=new a.a(t,n,r,o),this._picture}},{key:"_createTextField",value:function(e){var n=this,r=e.getAttribute(i.i.ATTRIBUTE_LABEL),o=e.getAttribute(i.i.ATTRIBUTE_ID),s=e.getAttribute(i.i.ATTRIBUTE_HREF),a=e.getAttribute(i.i.ATTRIBUTE_DOWNLOAD),u=e.hasAttribute(i.i.ATTRIBUTE_FOOTNOTE);return this._textFields||(this._textFields=[]),this._textFields.unshift(new l.a(r,o,s,a,u)),e.hasChildNodes()&&this._textFields[0].addListener(i.j.CLICK,function(e){return c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispatch",n).call(n,i.j.UPDATE_CONTENT,e)}),this._textFields[0]}},{key:"_createLeafMutationObserver",value:function(){var e=this;this._contentParentNode.nodeName===i.i.LEAF&&(this._windowResizeHandler=this._windowResizeHandler.bind(this),this._containsTransformProperty=!0,this._mutationObserver=new MutationObserver(function(t){var n=e._picture;if(t[0].target.parentNode){if(e._containsTransformProperty){var o=r.a(e._element);e._updateLeafSize(o.tx,o.ty),e._containsTransformProperty=!1}window.addEventListener(i.j.RESIZE,e._windowResizeHandler),!n||n.isLoaded||n.isLoading||n.load()}else window.removeEventListener(i.j.RESIZE,e._windowResizeHandler),n&&n.dispose()}),this._mutationObserver.observe(this._element,{attributes:!0}))}},{key:"_elementClientRect",value:function(){var e=i.l.CONTENT,t=void 0;return e.contains(this._element)?t=this._element.getBoundingClientRect():(e.appendChild(this._element),t=this._element.getBoundingClientRect(),e.removeChild(this._element)),t}},{key:"_updateLeafSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight};if(!this._previousViewPort||n.width!==this._previousViewPort.width||n.height!==this._previousViewPort.height){var r=this._elementClientRect(),o=parseFloat(window.getComputedStyle(i.l.MAIN,null).getPropertyValue(i.d.MARGIN_TOP)),s=n.width-r.left-o+e,a=this._picture;if(this._element.style.width=""+s+i.d.PX,a){this._pictureMinWidth||(this._pictureMinWidth=parseFloat(window.getComputedStyle(a.element,null).getPropertyValue(i.d.MIN_WIDTH))),a.element.style.position=i.d.POSITION_ABSOLUTE;var l=this._elementClientRect().height,u=n.height-r.top-l-o+t;a.element.style.position=i.d.POSITION_STATIC;var c=r.left-e,h=r.top-t;a.resize(s,u,this._pictureMinWidth,c,h)}var _=this._elementClientRect().height;this._bracket.draw(_),this._previousViewPort={width:n.width,height:n.height}}}},{key:"_windowResizeHandler",value:function(){this._updateLeafSize()}},{key:"dispose",value:function(){for(c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispose",this).call(this);this._element.firstChild;)this._element.removeChild(this._element.firstChild);if(this._element=null,this._picture&&(this._picture.dispose(),this._picture=null),this._textFields){var e=!0,n=!1,r=void 0;try{for(var o,s=this._textFields[Symbol.iterator]();!(e=(o=s.next()).done);e=!0){o.value.dispose()}}catch(e){n=!0,r=e}finally{try{!e&&s.return&&s.return()}finally{if(n)throw r}}this._textFields=null}this._bracket&&(this._bracket.dispose(),this._bracket=null),this._mutationObserver&&(this._mutationObserver.disconnect(),this._mutationObserver=null),window.removeEventListener(i.j.RESIZE,this._windowResizeHandler)}},{key:"element",get:function(){return this._element}}]),t}();t.a=h},function(e,t,n){"use strict";var i=n(0),r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var o=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._stemWidth=t+i.c.MINIMUM_STEM_WIDTH,this._stemHeight=Math.floor(n)+i.c.MARGIN,this._init()}return r(e,[{key:"_init",value:function(){this._canvas=document.createElement(i.k.CANVAS);var e=this._canvas;e.id=i.g.BRACKET,e.width=this._stemWidth+i.c.MARGIN+Math.ceil(i.n.TRANSLATION),e.height=Math.max(window.screen.width,window.screen.height),e.style.top="-"+i.c.MARGIN+i.d.PX,e.style.left="-"+(e.width+i.c.MARGIN)+i.d.PX,this._context=e.getContext(i.k.CANVAS_RENDERING_CONTEXT_2D);var t=this._context;t.strokeStyle=i.h.THEME,t.lineWidth=i.n.WIDTH,t.translate(i.n.TRANSLATION,i.n.TRANSLATION)}},{key:"draw",value:function(e){var t=this._context,n=t.canvas.width-Math.ceil(i.n.TRANSLATION);t.clearRect(0,0,t.canvas.width,t.canvas.height),t.beginPath(),t.moveTo(n,0),t.lineTo(n-i.c.MARGIN,0),t.lineTo(n-i.c.MARGIN,e+2*i.c.MARGIN),t.lineTo(n,e+2*i.c.MARGIN),t.moveTo(0,this._stemHeight),t.lineTo(this._stemWidth,this._stemHeight),this._stemHeight>e&&t.lineTo(this._stemWidth,e+2*i.c.MARGIN),t.stroke()}},{key:"dispose",value:function(){this._canvas=null}},{key:"element",get:function(){return this._canvas}}]),e}();t.a=o},function(e,t,n){"use strict";var i=n(0),r=n(27),o=n(17),s=n(61),a=n(62),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var u=function(){function e(t,n,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._url=t,this._nativeWidth=n,this._nativeHeight=i,this._isZoomable=r,this._init()}return l(e,[{key:"_init",value:function(){this._element=document.createElement(i.k.DIV);var e=this._element;e.classList.add(i.f.PICTURE),e.style.lineHeight=0,this._isZoomable&&(this._loupe=new s.a,e.appendChild(this._loupe.element)),this._isLoading=!1,this._isLoaded=!1,this._fadeOutAnimationHandler=this._fadeOutAnimationHandler.bind(this),this._fadeInAnimationHandler=this._fadeInAnimationHandler.bind(this),this._outline=new a.a(this._nativeWidth,this._nativeHeight,i.h.GRAY_CHANNEL);var t=i.h.GRAY_CHANNEL,n="rgb("+t+", "+t+", "+t+")";this._book=new r.a(i.b.SCALE,n),this._book.element.classList.add(i.e.IMAGE_PRELOADER),this._element.appendChild(this._outline.element),this._element.appendChild(this._book.element),this._contentLoader=new o.a(this._url,o.a.ResponseType.BLOB),this._contentLoader.addListener(o.a.Event.PROGRESS,this._contentLoaderProgressHandler.bind(this)),this._contentLoader.addListener(o.a.Event.COMPLETE,this._contentLoaderCompleteHandler.bind(this))}},{key:"_contentLoaderProgressHandler",value:function(e){var t=this._imageLoadProgressHeight/e.total*e.loaded;this._book.element.style.top=""+t+i.d.PX}},{key:"_contentLoaderCompleteHandler",value:function(e){var t=URL.createObjectURL(e.response);this._createContent(t),i.l.CONTENT.classList.add(i.f.SUSPEND_POINTER_EVENTS),this._element.addEventListener(i.j.ANIMATION_END,this._fadeOutAnimationHandler),this._element.classList.add(i.e.FADE_OUT),this._contentLoader.dispose(),this._contentLoader=null}},{key:"_createContent",value:function(e){this._isLoaded=!0,this._isLoading=!1,this._content=document.createElement(i.k.IMG);var t=this._content;t.id=i.g.CONTENT,t.src=e,this._contextMenuHandler=this._contextMenuHandler.bind(this),this._dragStartHandler=this._dragStartHandler.bind(this),t.addEventListener(i.j.CONTEXT_MENU,this._contextMenuHandler),t.addEventListener(i.j.DRAG_START,this._dragStartHandler),this._isZoomable&&(this._mouseEnterHandler=this._mouseEnterHandler.bind(this),this._mouseMoveHandler=this._mouseMoveHandler.bind(this),this._mouseLeaveHandler=this._mouseLeaveHandler.bind(this),this._mouseWheelHandler=this._mouseWheelHandler.bind(this),this._keyDownHandler=this._keyDownHandler.bind(this),t.addEventListener(i.j.MOUSE_ENTER,this._mouseEnterHandler),t.addEventListener(i.j.MOUSE_MOVE,this._mouseMoveHandler),t.addEventListener(i.j.MOUSE_LEAVE,this._mouseLeaveHandler),t.addEventListener(i.j.MOUSE_WHEEL,this._mouseWheelHandler),this._loupe.content=e)}},{key:"_contextMenuHandler",value:function(e){e.preventDefault()}},{key:"_dragStartHandler",value:function(e){e.preventDefault()}},{key:"_mouseEnterHandler",value:function(){document.addEventListener(i.j.KEYDOWN,this._keyDownHandler),this._loupe.element.classList.remove(i.e.FADE_OUT),this._loupe.element.classList.add(i.e.FADE_IN),this._element.style.cursor=i.d.NONE}},{key:"_mouseMoveHandler",value:function(e){this._mouseX=e.clientX-this._imageOffsetX,this._mouseY=e.clientY-this._imageOffsetY,this._loupe.updatePosition(this._mouseX,this._mouseY,this._width,this._height)}},{key:"_mouseLeaveHandler",value:function(){document.removeEventListener(i.j.KEYDOWN,this._keyDownHandler),this._loupe.element.classList.remove(i.e.FADE_IN),this._loupe.element.classList.add(i.e.FADE_OUT),this._element.style.cursor=i.d.AUTO}},{key:"_mouseWheelHandler",value:function(e){e.target&&e.preventDefault();var t=e.deltaY<0?s.a.ZoomDirection.ZOOM_IN:s.a.ZoomDirection.ZOOM_OUT,n=e.shiftKey;this._loupe.updateZoom(t,this._mouseX,this._mouseY,this._width,this._height,n)}},{key:"_keyDownHandler",value:function(e){e.preventDefault();var t=void 0;switch(e.key){case i.m.ARROW_UP:case i.m.UP:case i.m.ARROW_RIGHT:case i.m.RIGHT:t=s.a.ZoomDirection.ZOOM_IN;break;case i.m.ARROW_DOWN:case i.m.DOWN:case i.m.ARROW_LEFT:case i.m.LEFT:t=s.a.ZoomDirection.ZOOM_OUT;break;default:return}this._mouseWheelHandler({deltaY:-1*t,shiftKey:e.shiftKey})}},{key:"_fadeOutAnimationHandler",value:function(e){var t=e.target;t.removeEventListener(i.j.ANIMATION_END,this._fadeOutAnimationHandler),t.classList.remove(i.e.FADE_OUT),t.removeChild(this._outline.element),this._outline.dispose(),this._outline=null,t.removeChild(this._book.element),this._book.dispose(),this._book=null,t.appendChild(this._content),t.addEventListener(i.j.ANIMATION_END,this._fadeInAnimationHandler),t.classList.add(i.e.FADE_IN)}},{key:"_fadeInAnimationHandler",value:function(e){var t=e.target;t.removeEventListener(i.j.ANIMATION_END,this._fadeInAnimationHandler),t.classList.remove(i.e.FADE_IN),i.l.CONTENT.classList.remove(i.f.SUSPEND_POINTER_EVENTS)}},{key:"load",value:function(){this._isLoaded||(this._isLoading=!0,this._contentLoader.load())}},{key:"resize",value:function(e,t,n,r,o){var s=this._nativeWidth,a=this._nativeHeight,l=void 0;if(e<s||t<a){var u=e/s,c=t/a;l=Math.max(n/s,Math.min(u,c)),this._width=Math.floor(s*l),this._height=Math.floor(a*l)}else this._width=s,this._height=a,l=1;this._element.style.width=""+this._width+i.d.PX,this._element.style.height=""+this._height+i.d.PX,this._imageOffsetX=Math.round(r),this._imageOffsetY=Math.round(o),this._isZoomable&&(this._loupe.minimumZoom=l),this._isLoaded||(this._outline.draw(this._width,this._height),this._imageLoadProgressHeight=this._height-this._book.element.offsetHeight)}},{key:"dispose",value:function(){for(;this._element.firstChild;)this._element.removeChild(this._element.firstChild);this._element.removeEventListener(i.j.ANIMATION_END,this._fadeOutAnimationHandler),this._element.removeEventListener(i.j.ANIMATION_END,this._fadeInAnimationHandler),this._element=null,this._contentLoader&&(this._contentLoader.dispose(),this._contentLoader=null),this._content&&(URL.revokeObjectURL(this._content.src),this._content.removeEventListener(i.j.CONTEXT_MENU,this._contextMenuHandler),this._content.removeEventListener(i.j.DRAG_START,this._dragStartHandler),this._isZoomable&&(this._content.removeEventListener(i.j.MOUSE_ENTER,this._mouseEnterHandler),this._content.removeEventListener(i.j.MOUSE_MOVE,this._mouseMoveHandler),this._content.removeEventListener(i.j.MOUSE_LEAVE,this._mouseLeaveHandler),this._content.removeEventListener(i.j.MOUSE_WHEEL,this._mouseWheelHandler),document.removeEventListener(i.j.KEYDOWN,this._keyDownHandler)),this._content=null),this._outline&&(this._outline.dispose(),this._outline=null),this._book&&(this._book.dispose(),this._book=null),this._loupe&&(this._loupe.dispose(),this._loupe=null)}},{key:"element",get:function(){return this._element}},{key:"isLoading",get:function(){return this._isLoading}},{key:"isLoaded",get:function(){return this._isLoaded}},{key:"isZoomable",get:function(){return this._isZoomable}}]),e}();t.a=u},function(e,t,n){"use strict";var i=n(0),r=n(28),o=n(17),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._init()}return s(e,[{key:"_init",value:function(){this._background=document.createElement(i.k.DIV),this._background.id=i.g.BACKGROUND,this._content=document.createElement(i.k.IMG),this._content.id=i.g.CONTENT,this._mask=document.createElement(i.k.DIV),this._mask.id=i.g.MASK,this._mask.appendChild(this._content),this._skin=document.createElement(i.k.IMG),this._skin.id=i.g.SKIN,this._zoom=document.createElement(i.k.DIV),this._zoom.id=i.g.ZOOM,this._element=document.createElement(i.k.DIV);var e=this._element;e.classList.add(i.f.LOUPE),e.appendChild(this._background),e.appendChild(this._mask),e.appendChild(this._skin),e.appendChild(this._zoom),this._skinLoader=new o.a(i.a.LOUPE_URL,o.a.ResponseType.BLOB),this._skinLoader.addListener(o.a.Event.COMPLETE,this._skinLoaderCompleteHandler.bind(this)),this._skinLoader.load()}},{key:"_skinLoaderCompleteHandler",value:function(e){var t=URL.createObjectURL(e.response);this._skin.src=t,this._skinLoader.dispose(),this._skinLoader=null}},{key:"_restoreZoom",value:function(){var e=sessionStorage.getItem(i.g.ZOOM);this._zoomLevel=e?Math.max(this._minimumZoom,e):Math.max(this._minimumZoom,i.o.ZOOM_DEFAULT),this.updateZoom(),this._isZoomRestored=!0}},{key:"updateZoom",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(t){var l=a?i.o.ZOOM_STEP_ACCELERATED:i.o.ZOOM_STEP,u=-l,c=t===e.ZoomDirection.ZOOM_IN?l:u;this._zoomLevel=Math.min(Math.max(this._minimumZoom,this._zoomLevel+=c),i.o.ZOOM_MAX),this.updatePosition(n,r,o,s)}this._zoom.textContent=this._zoomLevel.toFixed(2)}},{key:"updatePosition",value:function(e,t,n,o){this._skinHalfSize||(this._skinHalfSize=this._skin.clientWidth/2),this._maskOffset||(this._maskOffset=r.a(this._mask));var s=e/n,a=t/o,l=-this._content.clientWidth*this._zoomLevel*s/this._zoomLevel-this._maskOffset.tx/this._zoomLevel+this._skinHalfSize/this._zoomLevel,u=-this._content.clientHeight*this._zoomLevel*a/this._zoomLevel-this._maskOffset.ty/this._zoomLevel+this._skinHalfSize/this._zoomLevel;this._element.style.transform=i.d.TRANSLATE+"("+(e-this._skinHalfSize)+i.d.PX+", "+(t-this._skinHalfSize)+i.d.PX+")",this._content.style.transform=i.d.SCALE+"("+this._zoomLevel+") "+i.d.TRANSLATE+"("+l+i.d.PX+", "+u+i.d.PX+")"}},{key:"dispose",value:function(){try{sessionStorage.setItem(i.g.ZOOM,this._zoomLevel)}catch(e){console.error(e)}for(;this._element.firstChild;)this._element.removeChild(this._element.firstChild);this._element=null,this._skinLoader&&(this._skinLoader.dispose(),this._skinLoader=null),this._skin&&(URL.revokeObjectURL(this._skin.src),this._skin=null),this._background=null,this._content=null,this._mask=null,this._zoom=null,this._maskOffset=null}},{key:"element",get:function(){return this._element}},{key:"content",set:function(e){this._content.src=e,this._minimumZoom&&this._restoreZoom()}},{key:"minimumZoom",set:function(e){this._minimumZoom=e,this._content.src&&!this._isZoomRestored?this._restoreZoom():this._zoomLevel<this._minimumZoom&&(this._zoomLevel=this._minimumZoom,this.updateZoom())}}],[{key:"ZoomDirection",get:function(){return{ZOOM_IN:1,ZOOM_OUT:-1}}}]),e}();t.a=a},function(e,t,n){"use strict";var i=n(0),r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var o=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._nativeWidth=t,this._nativeHeight=n,this._grayChannel=i,this._init()}return r(e,[{key:"_init",value:function(){this._canvas=document.createElement(i.k.CANVAS);var e=this._canvas;e.id=i.g.MAGNIFIED_IMAGE_OUTLINE,e.width=this._nativeWidth+Math.ceil(i.n.TRANSLATION),e.height=this._nativeHeight+Math.ceil(i.n.TRANSLATION),this._context=e.getContext(i.k.CANVAS_RENDERING_CONTEXT_2D);var t=this._context;t.lineWidth=i.n.WIDTH,t.translate(i.n.TRANSLATION,i.n.TRANSLATION)}},{key:"draw",value:function(e,t){e=Math.min(e,this._nativeWidth)-i.n.WIDTH,t=Math.min(t,this._nativeHeight)-i.n.WIDTH;var n=this._context;n.clearRect(-i.n.TRANSLATION,-i.n.TRANSLATION,n.canvas.width,n.canvas.height),n.beginPath(),n.moveTo(0,0),n.lineTo(e,0),n.lineTo(e,t),n.lineTo(0,t),n.lineTo(0,0);var r=n.createLinearGradient(0,0,e,0);r.addColorStop("0","rgba("+this._grayChannel+", "+this._grayChannel+", "+this._grayChannel+", 0)"),r.addColorStop("1","rgba("+this._grayChannel+", "+this._grayChannel+", "+this._grayChannel+", 255)"),n.strokeStyle=r,n.stroke()}},{key:"dispose",value:function(){this._canvas=null}},{key:"element",get:function(){return this._canvas}}]),e}();t.a=o},function(e,t,n){"use strict";var i=n(0),r=n(16),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0};var a=function(e){function t(e,n,i,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return s._label=e,s._id=n,s._href=i,s._download=r,s._footnote=o,s._init(),s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r["a"]),o(t,[{key:"_init",value:function(){if(this._href){this._element=document.createElement(i.k.ANCHOR);var e=this._element;e.href=this._href,e.classList.add(i.f.TEXT_FIELD_ACTIVE),this._download?(e.target=i.k.ANCHOR_TARGET_SELF,e.download=""):e.target=i.k.ANCHOR_TARGET_BLANK}else{this._element=document.createElement(i.k.DIV);var t=this._element;this._id?(this._elementClickHandler=this._elementClickHandler.bind(this),t.id=this._id,t.classList.add(i.f.TEXT_FIELD_ACTIVE),t.addEventListener(i.j.CLICK,this._elementClickHandler)):this._footnote?t.classList.add(i.f.TEXT_FIELD_FOOTNOTE):/\S/.test(this._label)||t.classList.add(i.f.TEXT_FIELD_WHITESPACE)}this._element.textContent=this._label}},{key:"_elementClickHandler",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispatch",this).call(this,i.j.CLICK,this._id)}},{key:"dispose",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispose",this).call(this),this._element.removeEventListener(i.j.CLICK,this._elementClickHandler),this._element=null}},{key:"element",get:function(){return this._element}}]),t}();t.a=a}]);